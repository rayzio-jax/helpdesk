<%= turbo_stream_from "ticket_list" %>
<div class="flex flex-col gap-4 my-4">
	<div class="flex items-center justify-between">
		<div class="flex items-center gap-3">
			<%= link_to "Log out", logout_path, class: "btn btn-soft w-fit", method: :delete %>
			<%= link_to "Home", root_path, class: "btn btn-primary w-fit" %>
			<p class="text-lg font-semibold"><%= @user.name %></p>
		</div>
		<div class="flex items-center gap-3">
			<turbo-frame id="next_poll">
				<%= @next_poll_time ? "Next poll at #{@next_poll_time.strftime('%I:%M:%S %p')}" : "Polling paused" %>
			</turbo-frame>
			<%= form_with url: mail_poll_path, method: :get, data: { turbo_stream: true } do |f| %>
				<%= f.button type: :submit, class: "btn btn-primary" do %>
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="Refresh--Streamline-Sharp-Material" height="24" width="24">
						<desc>
							Refresh Streamline Icon: https://streamlinehq.com
						</desc>
						<path fill="#000000" d="M12 20c-2.21665 0 -4.10415 -0.77915 -5.6625 -2.3375C4.779165 16.10415 4 14.21665 4 12c0 -2.21665 0.779165 -4.10415 2.3375 -5.6625C7.89585 4.779165 9.78335 4 12 4c1.41665 0 2.65835 0.2875 3.725 0.8625 1.06665 0.575 1.99165 1.3625 2.775 2.3625V4h1.5v6.35H13.65v-1.5h4.2c-0.63335 -1 -1.44165 -1.80835 -2.425 -2.425C14.44165 5.80835 13.3 5.5 12 5.5c-1.81665 0 -3.35415 0.62915 -4.6125 1.8875C6.12915 8.64585 5.5 10.18335 5.5 12c0 1.81665 0.62915 3.35415 1.8875 4.6125C8.64585 17.87085 10.18335 18.5 12 18.5c1.38335 0 2.65 -0.39585 3.8 -1.1875s1.95 -1.8375 2.4 -3.1375h1.55c-0.48335 1.75 -1.44165 3.15835 -2.875 4.225C15.44165 19.46665 13.81665 20 12 20Z" stroke-width="0.5"></path>
					</svg>
				<% end %>
			<% end %>
		</div>
	</div>
	<div id="flash_messages"></div>
	<div class="overflow-x-auto rounded-box border border-base-content/5 bg-base-100">
		<table class="table">
			<!-- head -->
			<thead>
				<tr>
					<th>Id</th>
					<th>From</th>
					<th>Subject</th>
					<th>Body</th>
					<th>Date</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody id="ticket_list">
				<%= render @tickets %>
			</tbody>
		</table>
	</div>
</div>