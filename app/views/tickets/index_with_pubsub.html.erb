<div class="flex flex-col gap-4 my-4">
	<div class="flex items-center justify-between">
		<div class="flex items-center gap-3">
			<%= link_to "Log out", logout_path, class: "btn btn-soft w-fit", method: :delete %>
			<%= link_to "Home", root_path, class: "btn btn-primary w-fit" %>
			<p class="text-lg font-semibold"><%= @user.name %></p>
		</div>
		<div class="flex items-center gap-3">
			<turbo-frame id="gmail_watch_status" class="inline-flex gap-2 items-center">
				<div class="status <%= @watcher == "enabled" ? 'status-info animate-bounce' : 'status-error animate-bounce' %>"></div>
				<p class="text-lg">Pubsub watcher is <%= @watcher %></p>
			</turbo-frame>
			<%= form_with url: toggle_gmail_watch_tickets_path, method: :patch, data: { turbo_stream: true, turbo_frame: "gmail_watch_toggle" } do %>
				<%= check_box_tag "gmail_watch",
                    "1",
                    @account.gmail_watch_enabled?,
                    class: "toggle",
                    onchange: "this.form.requestSubmit();" %>
			<% end %>
		</div>
	</div>
	<div id="flash_messages"></div>
	<div class="overflow-x-auto rounded-box border border-base-content/5 bg-base-100">
		<%= turbo_stream_from "ticket_list" %>
		<table class="table">
			<!-- head -->
			<thead>
				<tr>
					<th>Id</th>
					<th>From</th>
					<th>Subject</th>
					<th>Body</th>
					<th>Date</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody id="ticket_list">
				<%= render @tickets %>
			</tbody>
		</table>
	</div>
</div>